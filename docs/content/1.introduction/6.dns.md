# DNS

### Internal DNS

I would consider my internal dns setup to be "overly complicated".

On all VLANS, except for whitelisted servers, all queries to `ANY on port 53` are redirected to a local [unbound dns](https://github.com/NLnetLabs/unbound) server which is used to behave as a caching server.

ðŸ”¸ View my unbound configuration [here](/router-configurations/unbound).

Unbound forwards all `IPv4 & IPv6` queries to a locally running [dnscrypt-proxy](https://github.com/DNSCrypt/dnscrypt-proxy) instance which uses encrypts my dns traffic, among other things.

ðŸ”¸View my dnscrypt-proxy configuration [here](/router-configurations/dnscrypt-proxy).

If by chance, the query is related to either my `personal domain` or my `cluster domain`, the request is forwarded to a [k8s gateway](https://github.com/ori-edge/k8s_gateway) that serves DNS records for all cluster ingresses.

### Ad Blocking

I'm a huge fan of [Adguard Home](https://github.com/AdguardTeam/AdGuardHome). At the time of writing this I had just sold my previous router, the [Dream Machine Pro](https://store.ui.com/collections/unifi-network-unifi-os-consoles/products/udm-pro). It didn't officially support it, but with a bit of patience you could get it running on it.

Adguard Home is currently **not** running, because I am moving in the next couple of months. When it's grooving, ill update it here.

::callout
#summary
View the long list of blocklists I use.
#content
::list{type="primary"}
- AdGuard DNS filter
- OISD Blocklist Basic
- Peter Lowe's List
- Scam Blocklist by DurableNapkin
- NoCoin Filter List
- Dan Pollock's List
- CHN: anti-AD
- ITA: Filtri-DNS
- IDN: ABPindo
- IRN: Unwanted Iranian domains
- Game Console Adblock List
- The Big List of Hacked Malware Web Sites
- MKD: Macedonian Pi-hole Blocklist
- KOR: YousList
- NOR: Dandelion Sprouts nordiske filtre
- Online Malicious URL Blocklist
- WindowsSpyBlocker - Hosts spy rules
- SWE: Frellwit's Swedish Hosts File
- POL: Polish filters for Pi hole
- NLD: Easylist
- VNM: ABPVN List
- Dandelion Sprout's Anti-Malware List
- Walshy's Blocked Discord Domains
- Perflyst and Dandelion Sprout's Smart-TV Blocklist
::
::


### External DNS

[External-DNS](https://github.com/kubernetes-sigs/external-dns) is deployed in my cluster and configured to sync exposed services to [Cloudflare](https://cloudflare.com).

Ingresses with an explicit annotation fo `external-dns.home.arpa/enabled: "true"` are gathered and allowed to be accessed from the `WAN` side.


### Dynamic DNS

At any part of the day, my home ip address can change. In order to keep it up to date, I deployed a [cronjob](https://github.com/Kashalls/home-cluster/tree/main/kubernetes/networking/cloudflare-ddns) that takes place every (at the time of writing this) `30 minutes`.

It continuously checks and verifies that my current ip is equal to the `A` & `AAAA` records is up to date, matching, and updated.
