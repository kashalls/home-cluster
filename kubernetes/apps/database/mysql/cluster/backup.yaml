---
# yaml-language-server: $schema=https://kubernetes-schemas.ok8.sh/moco.cybozu.com/backuppolicy_v1beta2.json
apiVersion: moco.cybozu.com/v1beta2
kind: BackupPolicy
metadata:
  name: mysql
spec:
  jobConfig:
    bucketConfig:
      bucketName: kashall-mysql
      endpointURL: https://s3.us-west-004.backblazeb2.com
      usePathStyle: true
    envFrom:
      - secretRef:
          name: mysql-backup-secret
    serviceAccountName: backup-owner
    workVolume:
      ephemeral:
        volumeClaimTemplate:
          metadata:
            labels:
              type: mysql-backup-vol
          spec:
            accessModes: ["ReadWriteOnce"]
            storageClassName: "local-hostpath"
            resources:
              requests:
                storage: 2Gi
  schedule: "30 1 * * *"
