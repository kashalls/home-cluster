version: v1alpha1
debug: false
persist: true
machine:
    type: controlplane
    token: ENC[AES256_GCM,data:j3lytPQvvU7qfBXVzpMm9Z/zTw1glao=,iv:G930ye3JWYzs/QhUIGC4rFX7BKbquFpk2ugSQJX9Aa4=,tag:oW7MuYMLSEHC0RYM6DFfYg==,type:str]
    ca:
        crt: ENC[AES256_GCM,data:hEgTwyhZUrAnjpaMrv3iBPuPnrwBdrhvzWVBmO4+9egXedrgSrQOinG6AvJjOK8kvb81SElqdvdqoiks8TWAkJbgyJrSBh89g4QYHpyNrNabJH4ZxWV9/xjKuHzDnIwExA4lBkEzSJ2IhFPfLHtmg7ua//kqlvCurY7dazoxqhRcCpHujGNk1sB9RdMxieDT4GQTPtI+e8BPNDu6dVuIN5yrePeRda2Dt1YcopUWLEgtwq37LWIwkEvNmjkv7fafleD/wdphZoj/jpiZU3JEwyWdSTQ+b+bIwPbwZ7CMOGElFRDoctcUQ4drnZbvRIKzESkxD03fHE0TS7qcjK0BQ/F4JgEFolejlTxlEYnnt9AdYB6G2J5h+Xc80pXxzZmFjPqlLqKnoWvjKFcT4k2vFjTW1G9LkXmqD4xLhjE25ZT+X/6h1ZQvcFhKYKXOUiH978GGMqI15nea45Zf3m9cAnmbp9ejJY/c1AXdGZc3NPg+JFQmItMUSGW4hDfW6ed6vCdKL1pYpvP7WUIVujmMOyuKbDzdONZc1t7MxxQszC+8Gq8Q9O1fZP3Ya079/aAOjYHcP+zYx4dcZm3uaFGLLrWTXnLz6EneOHmk5Eq8cZALy+u+u5YQ7oz9cWpbH+L9e2WwF4/jZuS6SGSdnwndMGcLrIpYMhT/XSBpkrMPEg26aaC+at7qVNBYI/hIAVdpg49By2q5aZcZZPPzbHV5jCkMxdQUZ2/8MV22YZ89tPI5ey2ys6S01PjKUy8IE5OM47usbGsJ0gAdW3GFTNmn2DsHItTcq8gxVKpok5a6zvBKa18FQo+XygsntMMq4940TKkhIVXqeEdbUYidmZbG1uzom96HpwshMcXAlHFo08T5HL6h,iv:TXZzmXtGOqEPILk2zBF5jQQzIOFvsuC7sK9Y+LQWNLE=,tag:S+OMWhbDZfdkeEUJ/Okfpg==,type:str]
        key: ENC[AES256_GCM,data:uOZ1KNC0hvsPq5SbONEk2Z1a75RpAlKhr5IIpiQ6AVmyObldUkjxGcqGMe/qqDp2bRVbpAwgO/flyeuyA+PDCfAYH/ekAbi5I3BeZL0SIXOUMpAltFKPpUcnNNsBQS27juEuui9Uq+afsKbQ3oxrHL4twTH4mIkFopyhzzJACqGtjCwXMPjY99iABWqDs4g9gAgJ8JQargCbWWEByW4oYopkFFJ7yKrFujFZ2THllOGWbaXw,iv:L2GccKz9BxwFPV46e6ailqiPmOcy3BsYPuFWNhRgpvY=,tag:eO/D52DHl77LzlLo2nlbLw==,type:str]
    certSANs:
        - 127.0.0.1
        - 10.69.0.2
    kubelet:
        image: ghcr.io/siderolabs/kubelet:${KUBERNETES_VERSION}
        extraArgs:
            image-gc-high-threshold: "55"
            image-gc-low-threshold: "50"
            rotate-server-certificates: "true"
        extraMounts:
            - destination: /var/openebs/local
              type: bind
              source: /var/openebs/local
              options:
                - bind
                - rshared
                - rw
        defaultRuntimeSeccompProfileEnabled: true
        nodeIP:
            validSubnets:
                - 10.69.0.0/24
        disableManifestsDirectory: true
    network:
        interfaces:
            - deviceSelector:
                busPath: 0*
              dhcp: true
              vip:
                ip: 10.69.0.2
        nameservers:
            - 10.5.0.4
    install:
        disk: /dev/sda
        extraKernelArgs:
            - mitigations=off
        image: factory.talos.dev/installer/${TALOS_SCHEMATIC_ID}:${TALOS_VERSION}
        wipe: false
    files:
        - content: |-
            [plugins."io.containerd.grpc.v1.cri"]
              enable_unprivileged_ports = true
              enable_unprivileged_icmp = true
            [plugins."io.containerd.grpc.v1.cri".containerd]
              discard_unpacked_layers = false
            [plugins."io.containerd.grpc.v1.cri".containerd.runtimes.runc]
              discard_unpacked_layers = false
          permissions: 0
          path: /etc/cri/conf.d/20-customization.part
          op: create
        - content: |-
            [ NFSMount_Global_Options ]
            nfsvers=4.2
            hard=True
            noatime=True
            nodiratime=True
            rsize=131072
            wsize=131072
            nconnect=8
          permissions: 420
          path: /etc/nfsmount.conf
          op: overwrite
    time:
        disabled: false
        servers:
            - 10.1.0.1
    sysctls:
        fs.inotify.max_queued_events: "65536"
        fs.inotify.max_user_instances: "8192"
        fs.inotify.max_user_watches: "524288"
    features:
        rbac: true
        stableHostname: true
        kubernetesTalosAPIAccess:
            enabled: true
            allowedRoles:
                - os:admin
            allowedKubernetesNamespaces:
                - system-upgrade
        apidCheckExtKeyUsage: true
        diskQuotaSupport: true
        kubePrism:
            enabled: true
            port: 7445
cluster:
    id: ENC[AES256_GCM,data:hyT6CpKrEEGwdi/F55cREv3y8nZK+vQ6D36uet0gMc/qGrqh0KpTArNTX6A=,iv:TQBaR/Ps4WtPBnhckzXVuuYTuVy09dTs9esYk2Pzuto=,tag:PRP3tVEQsc+imVsj3PkzAw==,type:str]
    secret: ENC[AES256_GCM,data:GYleqpv8ZDwq/yh7tEmgKK5LBT/nsZNf9qSNSREd/kVuXE9VHDDuWN/XYhU=,iv:cZ1nzw5TVycW9dtf1+KVobeYiFfPrmQxQB3OVYfow78=,tag:zuthnkyis5aWk5qZnkOvEg==,type:str]
    controlPlane:
        endpoint: https://10.69.0.2:6443
    clusterName: main
    network:
        cni:
            name: none
        dnsDomain: cluster.local
        podSubnets:
            - 172.30.0.0/16
        serviceSubnets:
            - 172.31.0.0/16
    coreDNS:
        disabled: true
    token: ENC[AES256_GCM,data:q/+KVcCXOMMMBt5dajEozVJEKHekqDM=,iv:CtlOPojRLN+2Sgu0FI2rtLgEAEqhlxUVsBlvPzLJ+Zs=,tag:rkgMk2zHvFSjFUwV06CfBg==,type:str]
    secretboxEncryptionSecret: ENC[AES256_GCM,data:Lf1WWWiLhdOrXhIGLlWvuCs4VfILQk/KtOinDq7SnEfDQiuSNRP9NRtNcoI=,iv:4yoPJWHMCrDZ1MRQ12NTUXoTrx1RN2M4jhRSgtf0NIA=,tag:ykEBDH9PBQ+oNn24JoaE6g==,type:str]
    ca:
        crt: ENC[AES256_GCM,data:mauuNEwj6ufvFxx0+DWEOWL7WNU99Dh2tG5BQfmWjssABoisTKj4u6zZo3Urm7x9u/Bcpu8Jx/7UpxLuX0uKSyzBCjvIKT8Akr46TO0MC6Qiy9g2eappRDFDzFVEhr40UVH1dJvqn993DernyV0YIDXAjFiFcbtY0AtAWM7Zqf4KrzX6ouThNO5vdUe3cbofoOJWxPdUxYxBcufjBlG4Ueu6+v8sJshTXw/U6ufW8qEg515s3F2TyUfZu9gdGvNP8uBeC9ipvRXjnDCvztuOr9k/BT8nt5eki6vC4wpKKD2i+nmQuSVG9E5LxrRibGIQ9Vj66WbIxYpx8XN7ZXGymsX+aQskdJ4gJCVGZK4VdxXj0/aqDliEYMqDE0DOH6PRbKbect2wnX4L48NIDhOpIxeX+eaLFtrfLs0QcEzB4OVlSppD+8XQepMQ17/9GBKu7dovnbdV/RsTkBYqsBlgoaDNgSL+9WQT0m5hSKRFDIY2OnjzRP2tu83qMbUWT8wVMM6QplPHCY0xHaCmB0EGwPzO0WCeXhLY/a9lie4ALbt+rSQdQBDw4vFoMRKhRUrd9cuIlEr9VkyTEQ7kKwz3CO96bsFhgfCg4yZ7oGEMmbYvr0u872LgTQmXSWresyuEcsXZIsjLYlEsEDhX8q7I4arx1hg6uP1XtiLQ2cdq5oxLKEXQLdlmCYP3ULqnYBYBXIJrXmjuS/RS3/Rj+Py/7e5gxwN//dtbIr7wSSLU9UvGBu2ZdFrB2coloqNYZRIxYjRPWTKsAcswIMpWOjKmQ9icRcCNtyTp8WdqtsVRi2ZH2gINpCuImcCL2i5aVdjKi52C0wqDXDy8OqQyddyEYXgX/OFf/dDEW6lz0soyEwcINDQqhuT0/0F2Ha/xBmZKL42827y7pSHekHLF515eQEbViNd6WgU0M9Z0Py1jhwDQZbhe8d8BJi0dwo97q438vFA/uwlSpWfsVR52jz226v1+ffGafrHpE9nboFJlorT0qYekHv8ftz5fx4KI8zAJExX3Humn+eZndqCDHEzYy4lJ7Pw=,iv:J35AD6aGcCwX+n0SXjtT7+whQXn1FTT/XzDwqKp3/So=,tag:RcNgCAx9PME7SsiQFT52Zw==,type:str]
        key: ENC[AES256_GCM,data:ipRE4XRTTKayu2XLAbtiD9bpcw1E4PuNkFUJ1LZGctKV6IVJII81kts+VFfM/AscRp9+LbN/pHJ5ey60p22raaOg81jyM+vFS8uwiomCrDvEw4sLOznTxWJOcybyyD/py1ArAaVKoff5747ZG9D7NSAQqGAZ0iO0O3wV7Viocvu6tQmKXPXsZOcM/iJcNvcANZEnQU0paZcE8icrkj4nqwdrrTbSjFCjPLf4dYyUFgh2nQLfWYb0eODdnnsCCMgbQhn/89tXfVzF8faEzG97Ks68IlxhbywAfEq42gyyBCyIS3+OjAS6B4GAPx7ofcDOaMvnq48ZeyCJrx8TLBAdCzORbuSi2sBeHip1TGkLajSfrc25kO+Rl9HMgHVAgxQhA0q/uVOyTEYniY7vynzNEg==,iv:qUz7Jn7vldhSb6qxoZtZ1bD3fX1IgXwFLqO6m6Cg1jU=,tag:5tKXuEWc8LGBRzzbdGoKWw==,type:str]
    aggregatorCA:
        crt: ENC[AES256_GCM,data:RcyWLN6y1MTcMrIUSPpplbA8OpaZuCYNrfdEcRZdFqodTK5soFBo7rIuJPCtonNhzeH5gcEmDyKB1h7p/wX6vlbb9QIBGQawGOS3RAds1rbFEEd1jA4nAuqNsMqLNeCDd39E+UOGFCuyEbzQ7JAOnUTbMppxMx4iLpz+23cXCCuSFyeda9XoLA2DZ6+xDxruuNP4OVWF00eFLYBgQdNT1TYvtmsIW6MnK42UogWwsNDi8xPZ5NbNRlBKeDq/wtDkpBCIJwYDF20Oh+V1eFXIPk4HXVjVwDWApuYAPZ19aRZbvwhA3i0uAbv/42mdLcCuZIXgBSyJbjKeluS/rIdfT4GtwCIDbCHvVS79/K9QqMiloOWYExfcqvljsd3cV5t+l44ar14P/s6cqmVC7ymT9udnaiJdkxwodobWbyr+z2yRHGHuzdObQyRbQpd6jOxT9NlrVPZVSTJCxH6fWSc/zDNnO4iBhktUhCGsA4gK3K3B70tiBEypCGuUJeM7VFK6N9RcW/XR2StGu0w9+7PDZKgBdLFh7O3ujcG2xFwMaxYQnbbJQw5ewTSN8y/qBb5i8YXkhVt0xKLZxEdGryNBEC5GJQljv/BF+Uw/7lfKIV62T6YUFSsRRhmTt6VD4Nz/nnbNfWWTfQSvw/r9Dp1IlYdEDO8rxALEwcSgh10xi1kTN2eNdw1wNSUyTJjg+XPJbz+kgdzUDMv9gZbYN5fbq7Qgrhj/k19r2u3blev0v2oQkCY6EnB9BqOluVDo90/PiD5FiUQK8mcu/hYOVBshu7fTnpIiEcMOkcbyMIVImlPKkMzW47/AxGIja+b0cZr5+qiFaeKqluhqI9QKKoHewuRKIf1a1o1Mh+tw3HN0x4meSgb50+vxbjnYuz8ke2XANNpW/5v6XBkCPACUO3NgIrlWImsOX0HrBRLLxpfW922r6u9udFM+fknxhVdQcSqX,iv:7f6C+11spzODRzUDbqxYOLoHMI+VZbOt+alEJ2om/vc=,tag:nx84qyVsl8MY3+omsEaHxQ==,type:str]
        key: ENC[AES256_GCM,data:LIAcyZdF9Gw+S5olnMHe20hvAxjyWzsV2+5ZIVq6W6IbFHCLYuRY6DYGXIU3XUCqh9P1a+0r7vh3ktoLHViTZDnRUyHQJESdwlQ64Nnm0G0JJDz4NySEdLW6h2KkOUuf89TlRp0A74B29QqQe7RQ1IuVlOGMAXKbGgTfjyxfTAcyRLxqKJDCEeKDuU6TChpa3OND63FaKV2ihi9oXyYC7QyxT0SfrSlLhQ6xWGB5YVLGVjLWNRJglIKvGFrCrY0FZn9/1n/wD9awYPE9dTyevDWeQg7LjBlKj4tXB46wTcKuIdM0OjBRutZOENcXT25TMoQ8t1aI5WL3vORN636qqiK6x6CVBXPYJRMiFrqh9d5pNiWV4aaqxRAegQ/UW0VvQGogGFhOm65uvjXphOXj1A==,iv:SF0wA4E1FM+s7UEK4tmPJDDcyiWGyH5CwPls05ULiqs=,tag:wDw+nl9huK7suVlwogNC4A==,type:str]
    serviceAccount:
        key: ENC[AES256_GCM,data:BLhM5ovC9mjAmHPSSwqJoJBei1FAMnkkL5GTUxYfs2gzYV1HCMmsdn05RUTLSwHlUJVT2vLhkPPLWXXORBxvYx9jGJqyrVOv5zk1zVDcod+ZDIcbRiEjSEkHWmJ923XRihhzvJ//Nv3imfGvye0kTLahpK/jimfeNQ0+IoD71wdGyXZLtydBEDWtWADMQzpoKSJ2pJeIlF8zgdcScQZeSsP7GVbHqzfVGNf3esqpPdc4LA6n0Md3L5/rcrjapYAKMA9QRV0HFQ8+9mCHQUzeGwtgk6EyAAlhD9WW9K+Gz3i0LKnEpRSWKqUs1WgprtKvzplGQy5eB5PPf0kwtBZgDtekIa7GXE1K4zAFMG8nFNyALYoMZyVDrqZL6rNGOzFxf9fYWeflp7UjeVVHedFDFA==,iv:BhwZIU4tRh4pJTpYtUr6NeZlM1yWBq9BIkyoYWgUyQ0=,tag:B1nabJJx0eMONHV2Jgo50w==,type:str]
    apiServer:
        image: registry.k8s.io/kube-apiserver:${KUBERNETES_VERSION}
        certSANs:
            - 127.0.0.1
            - 10.69.0.2
        disablePodSecurityPolicy: true
        auditPolicy:
            apiVersion: audit.k8s.io/v1
            kind: Policy
            rules:
                - level: Metadata
    controllerManager:
        image: registry.k8s.io/kube-controller-manager:${KUBERNETES_VERSION}
        extraArgs:
            bind-address: 0.0.0.0
    proxy:
        disabled: true
        image: registry.k8s.io/kube-proxy:${KUBERNETES_VERSION}
    scheduler:
        image: registry.k8s.io/kube-scheduler:${KUBERNETES_VERSION}
        extraArgs:
            bind-address: 0.0.0.0
    discovery:
        enabled: true
        registries:
            kubernetes:
                disabled: false
            service:
                disabled: false
    etcd:
        ca:
            crt: ENC[AES256_GCM,data:+a3oKdBnLbOqXwPfKBpGTUAi1n5/T6QMzbrKKsdye3S111WplkMDaU+NPhqlEE7y6fbVRlroQrc3lcZ+BiTySqaeUMU0899eFr81ue58TEaN62tk/x8uVC/LoU8hrOBdZhXzZHBtapDEhmkoIrNzMvzfPwpaF5zodoGRSosfGnG1uoQ5VmdsQs424dY8CEkN1IOIm99ktZFPh7AxE1jhgxLiXWJhan/5/j7LqDKYAA6eslMMwhw3wz1DfwQ7XfhI7Yjbcs9SoH8NZ6iy97dxNtrtOWNy3zmfjiMWUlBRv8t8bam6CIfcJXMATg/DXUM6N4aXwzO5HxWl5L7ouEsX2nLItEJVV0T8VmI8UmJndvLvUn0Vtm3ZHeYtP4fTIEacio6eu4Eb/0uT98wC8n2pDYY7WbFWtXAVas0NtQI5CVQyOUHpgyp7Jjc3VfDd3Izn5W99il/guAkhYYTxdl9KpR2XoIquDCdGizI7UHeX1bAV+MEqhPfttvdzwSq4dEuHmz7PcfGaFgqm4dbIA4KP/0tJEb2IWKMdSrlVy3YWFs1hnguGk5+rGcL7P4FTL5xdvw4FnlDGm5EGhOIGWOBwlzMIke0Zxrf7kmABoV+mAlv4p39y1LQEIjHZwIW2WGGOOBIfRQz0qMXnH3UEQT2BT3u/euMmJJXy5EpSwCfjq9QILBGc0j85cWrqbYH77FHTsMdHl3LStgaPyc97UnsFtZxPGCuT4W4QOURqKsQU8HvDoIV1Z9zKzv26DITne7M2bgBl5+dwFOxpUIuwI6NJJCu7Tst9l47Sg41fWGXA+NdacQm+Fatv4QdtAp0+g6gh3V1RlaMRYBWCgjMEQwrK/gvLmJtm1hRsf97IbzcseaytC9dPtrdTOxmznGwhmRIXMFquNZWXgsBGx+5MvYc0r8NbYHSjOOekZxBxILzv+v63o0Bq5HcnzmCTzEwsL7OOc+R6E3UqPgLe7iAt13OjJkDcAI32vCs5xaufQzki5nyUKXqsKrT1YHG82OXOBleAiTnfoA==,iv:yvNkDLKsg7i49yQA1n3AhZqrigTt1YTJHWuVp30CR44=,tag:yP0tlwcIfn7wtz8CnkUbfg==,type:str]
            key: ENC[AES256_GCM,data:JwAy6wF8m3M1tE9haElCN/WZd8wnudoXiRCPqV1NLMOqZUQQ4+cysNT6ceaTax2EFe4GvdDbE7ciyN+L//RjgMrXNSdhZBmn+SaJ/cNueB0PoGvfwrwKbA6bDDEigmP6hkmvZMmqz+8/pJG2WktaK8gULPh4TxMfqXCIQNYGae9wioGV8Uw/5GcbfX9DP0NJ6Q9YKBiLRKfdLEQxgn9psVmU8PKC603QUy0h4I56AsYMi+qp0Rx1ySthhD0KJ8oieQKYSp36kJ8xcUGDi79MKCIk3lUMrVNPrjKZiqIr15uKS0uWujfOfc1f7Qac2o7gctQfJ6BsXbe0VJiO9V4KEyhYDk9ekxa07e/6oV/EoCCyglSTVBBieDtnzgpY3DPluJpp7kvAKyz1tr4Iw7URcw==,iv:hECb+cguUyf4/IZQXt+bYv34DX/HodQJ6cNumsLz9Bc=,tag:Av2U7YzBJpB9eVR4W7FOKg==,type:str]
        extraArgs:
            listen-metrics-urls: http://0.0.0.0:2381
        advertisedSubnets:
            - 10.69.0.0/24
    allowSchedulingOnControlPlanes: true
sops:
    kms: []
    gcp_kms: []
    azure_kv: []
    hc_vault: []
    age:
        - recipient: age19963x2afvcsek4p5sas5n05thusjvzz7gpfknp20666u69jw44lsu5w4u5
          enc: |
            -----BEGIN AGE ENCRYPTED FILE-----
            YWdlLWVuY3J5cHRpb24ub3JnL3YxCi0+IFgyNTUxOSBUa2V4K0ZVbW9wWWRZRTlE
            WjkzRDJvOFBESW8yYThOZHhGUnM3TGcwRUQwCitUNHg0cHo2L3F5d2lmT09BK1dV
            WVlMeko3SnNQaW5GTk91alNCcm9oTFkKLS0tIHpXUVh0elFXSmd3ZThENnZjM0Ux
            RFBjTVNIOHJDSlBDZytDYkdPcU9ibFEKeCgZ5lPqLPjRZVq6GB6h0z9sfK+mx8dn
            HenmK8zOidyr9FesmLoS2sNjkYvybs9lJMQcJ1B8Vita3yOu8KQBgw==
            -----END AGE ENCRYPTED FILE-----
    lastmodified: "2024-03-28T21:58:45Z"
    mac: ENC[AES256_GCM,data:ltt5ZPlZ9I/IufgMDFngyw6kiRuVgxqJr/bRKOlbrVFUED4c1qFMqG5BvH/1hpORyqV+CnwrvqJ+z1y3lc//kc3qidG+w4LRZjGbP8AEuVB5EXlyMOyQjYa802uKyzZsDwMIEIuznDI3LGIF8opwSJRioPbL4WMiZ2tG6dsj/8k=,iv:tLeDci2Z6ExpqM1Pd9tvKxUYrSGdo0SoTk031xJSJPY=,tag:fJlJdfEfD7pDF8krN2EWwg==,type:str]
    pgp: []
    encrypted_regex: ^(token|crt|key|id|secret|secretboxEncryptionSecret|ca)$
    version: 3.7.3
